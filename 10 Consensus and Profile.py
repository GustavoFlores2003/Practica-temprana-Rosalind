from collections import defaultdict #Importación de librerías


def leer_fasta(texto): #Función para leer datos FASTA
    """
    Función para leer secuencias en formato FASTA desde un string.
    Devuelve una lista con las secuencias de ADN.
    """
    secuencias = []   # Lista para guardar todas las secuencias
    sec_actual = ""   # Guarda temporalmente la secuencia actual

    for linea in texto.split("\n"):  # Recorremos cada línea del texto
        linea = linea.strip()        # Eliminamos espacios o saltos de línea
        if linea.startswith(">"):  # Nueva secuencia
            if sec_actual:
                secuencias.append(sec_actual)   # Guardamos la secuencia anterior
            sec_actual = ""  # Reiniciar la secuencia actual
        else:
            sec_actual += linea  # Acumular bases


    if sec_actual:
        secuencias.append(sec_actual)  # Agregar la última secuencia


    return secuencias


def calcular_matriz_perfil_y_consenso(secuencias): # Función para construir la matriz de perfil y la cadena consenso
    """
    Recibe una lista de secuencias de ADN.
    Devuelve la cadena consenso y la matriz de perfiles.
    """
    if not secuencias:
        return "", {}


    n = len(secuencias[0])  # Longitud de las secuencias
    bases = ["A", "C", "G", "T"]
    perfil = {base: [0] * n for base in bases}


    # Construir la matriz de perfiles
    for secuencia in secuencias:
        for i, base in enumerate(secuencia):
            perfil[base][i] += 1


    # Construir la cadena consenso
    consenso = ""
    for i in range(n):
        max_base = max(bases, key=lambda b: perfil[b][i])
        consenso += max_base


    return consenso, perfil


def imprimir_resultados(consenso, perfil): #Función para construir la matriz de perfil y la cadena consenso
    """
    Imprime la cadena consenso y la matriz de perfiles en el formato requerido.
    """
    print(consenso)
    for base in ["A", "C", "G", "T"]:
        print(f"{base}: {' '.join(map(str, perfil[base]))}")


# Ejecución del código formato fasta para resolver el caso
entrada_fasta = """>Rosalind_7159
GGACTCCTTCAAGGGTGCTAATTATTGCTTTTTGGGGAACACCACATCACCTTAAGAGTT
TACCAGGGGCAGCGCTTCTCGTAACGACCCAGCTTGTGCCTATGCCGTACCTCTGACCAG
TTTTCTGTGGTTTGAAAGAACACTCCCCGGAATACGGGACAGTACCCATGGCTGCGGCCG
GAGAGCTCTCCTTCATTCGGGAAACAGTGCCGTGCAGATCAGTAGTTCATAAGGTACCCT
ATCCTGGTAATGAAGCCACTCCCCGAAACACTTTTCATGGACTGCCAATCGTTTCAAGTG
ACATTAATTGGCTTCACTATCTAGACTAAGTATGTGAATTTTCAATATCACGTCTGGCAA
CACCTTGTAGTCGCACTCCCGGCGTCTTCAGACCCGCCCAGGCGCAGCCCGTCATGATAC
CGGATTAAGAATGATAGGTGGCCCGTTGATAGAATCGCATAGTCATAGGGGTAATCCACC
ACAACACTGGCGTCAGTAATAGACTCGCCGAGATCGCATCGTATCTTTACCCGTGCTCCA
ACCACGCGGATCGCAAAGACTTGACACTGGGAGCCTAATGATGTCTTACTTCCTACTATG
TTATGCTGACCATGATTAACCTAGAGTCACTGAGCATTACCAAAAGAATAGCCCCACAGG
TCGTGGAACCAATGCAAGCGGACACATATGTCCCATGAAGCAAGTGAAAGGGAACTCCGA
ACGGTAAGACGCGATATTACTACCACGAACAATGGAAAAGGCCAATATATTCATACCCCC
TCCAAGAACAACATCGTGAAACCCTGGTAGCCCTTTACTCACATGGAATATCCGTTACTC
GCGTCCCTCTCCCAGAGGAACGCGGGATAGTGAGCGATGAGCCATTAATCTTTTAAACGT
AGGCCTACCATGGTCGTAACGCGTCTTTGACCGCCACTAGTAAATATCGATTAGCAACAC
CGGGAGGAATATCCTGATCG
>Rosalind_1894
TATTATGCGTGTCTTATACCGGGGGCATCCATGCATAAGATTCAGACATCCAATACTCTA
GAGGCGCACGTGAATCGTCAACGGGAGGCCGCATGAGTTTAGCATCAGGTATGCGAAATT
ATTCCGAAAAAGATCGTTTCAGTGCGATTTGCAGTGCGTACGTTACTTCGGCCCTGGCCT
TCACGGCACTGCCGGTATGTTAATGTAGCAATAGTTATATTTCCAATCAATAATTCTGAT
GTGCCGTAGGAAGTTGGAAGAGCGTCCAGGAGCTTAATCTACGAGTCTCGAAACGCAGCA
GTTCGTAGTGGATCTCCGCAGTCTCACGGAAGCACTATCTTAGCAAAAATTCGACAAGAG
GGACTCCCGCAGAAGGCGCTTTCAGTTGAGAGGGAGGAAACCTCAAGAGCAAAAGAGGGT
CAGATTGAAGACGGATGCTTACCCACCACTGTTGCGGTACCCTTCCGTGTAATCGTGTGT
CTGCGCCGCCCGTTCGTTTCGCCCATCGCCATATTCCTTTGTGGGTCAGCCGAATTAACC
GTGTAGATTCACCAGCAACGAATCAGTGGACAATTGGACCGGAGGTGCTAGTGTCCGATA
ATTCCCGACGAGTAATTGGACTGCGACTGAAAACAGATCATCAGGTTATGCTGACCGTAT
GGAGCTAAATTTACGCCGAAGTATAAGGCGACGGTGCCTTGAAGCTGGCGTGTAGGGGAG
ATTCTTACGACGACAATCTAATGCTCTCCTCCTGCACTCTTCCAACATAGCCACCGCGTG
ACTTCGTTGCCATCAATATTCGGCCTAAGCGGGGGAAGCGATTGCATCTCTATGCTTCAT
GTAAACTCAGACACCACTATCTTTGTCCTGTAGCGACCTCGTCCGTAGACTTAAGGGCGC
AAGGGCTCTCTCTCGGTCATTAGCCCTTCGATTCCTATGCGACATTTTTTCGTGGATGAT
ACGAACAACCCTAATGTTCT
>Rosalind_3762
ACGGGAAGAATGTGCATGGGGCGGGGTTTCGGCAGACTCTATCTGAGTAGCAGCCATTGG
ACTAAAAGCCCTGCCTTATACCAAGTCGGGTCTGGAGCCCCGTCCCTCAGAGACCCGCTT
AACATTTTCTACCCCTTGCGATGCCTACGACTAGCGCGGCTGGGACTCCTAAGGAATAGC
CACCTCGCACCGGATTAGCTCTCGACGAATCGTACTCTGTTAAAGGCTACTGTGACTGGT
CGGAGCCCCTGTGAAGAAATGCAAATCTCTCCCGTGACATCAGGAACGCACTTATAGAGG
CATTCCGGGACGAGTTAGTTGCTAGTTGGCTATATTTCCCAGCCGGCTCGTTAATTCACA
AGGCCTACAGCGCGGGCGACCGAGTTACTAAGAAGTGTCTTAAAACAGCGTCAGTTTTCG
TTTGGACGCAGACCCGTGGCGGCCGCCGGATGGTCAAGGTATACTCAAAGTTTCGTGTCC
CATATTAACCCTCTGTGAGCGCGTTCACTAGGGACGAGATGTGGCGGATTCGGATTTGGT
GCCTAGATACGTTATTAGTAATTGTTTCCAAGCACCCTCATTCTGTGTAATCCCTATGGT
ACACGTCTTCAAACCGAGCAGCAACATTGGCATATACAGAGAAACTAAAGCTGGGGTTAG
CTTCGAGAGAGGACGGTCCGTTTTTGACGTATAAGAAAGCTGCATTGACATCCTACTCCT
GCCAGTGGCCGAGTTGTGTCAGATAACGTGGATGCCGCGCCGAATCTTGACGGTCTAGAC
CGACGTTCAGAGTCGATGCACTTCTTGTCAGTCATCCCTCCTAACGGCCTCTACGTAAAT
GCCCGCTTGTGACACCAGTCGGAAAATGTTGACAAGGAACTAGAAGGCAGCGAGACAGCC
TGTTCACGTTAGGCCGTACCGACGCCGGCTCAAGTCAGGTTCGTGTGTCTTAGAAAGGTA
GGTGCTACGTCTCAATCCTT
>Rosalind_9270
CCCTGTCATCTGAATTGTCACTTGTCGCATCCTCCTAACAGTTGCTTACGCTAGAACTCC
TACTGTACCACTTCGATAGGAAGGATAGCACCAGACCGAACCTATTTAACATGGCGCGTC
ATTGCAACCGGGTCTTCCGGGGATGCCGTGGGATCCGAGATCCTGGGCTCAGGACACTAT
GTAATTTTCATCACAAGCTTGAGGCCAGTTTGATGGAGGCCCCGTCCTGAACCGGCGTCT
CGTTCCACTCAGCCGTCCTGGCATCACCACCTGTCGATGGACACTCATTAACTCCGTTTC
GCGGCCTTCGTAACACACGCGTGGCAGAAATTAGCTCCCTACAACTCTGCGGAACATGGC
GCACAGTGTGTAAAGGTGGATTTTAAAGCCCGGGTCCCTCACAATTCGTGATCATATATC
TCGGATTTACCACGCGAGGAGTGCTGAATTCCCGCTGGGCGATGCTGCGTCTAGGGAATG
CATGTTTTATAAACAGCCAGCATGTGAGTACCCAGATACCTGTTTCCGTCAGTGTCACAC
GAATTTTGTACGCAGCTCCCGACTGGCTCTGCCCTCGGAGTGGATCTTAAGATCTACTAA
CTAAAAGAAATGGAAAGTTCGACTTTGCAGAGGTACGCCATAAGCGTTGCTCAGGTCACT
AATATTGGCACGGAGCCCGGCCTTGTAAGCATCTAATAACTGGAGACTGTCCCTCTACCT
GCCCCAAGGTTTGCTGGTGAGACGTATTCCGGCTGCTGGAGCTGGATCATCACCACAATC
TGATTCATCGCTCATTGAAAACAACGACGCTCCTAATGATTGGGCCACGTCATATACGTT
ACTGGTTATAACAGAAGGCAGTACGCAAGGTTAGGGATGCGCGACCTCAAGTGGCGGAAA
CAGGCAATAAGGTAAATATGATCGTGCGAGTAGGTGAATATGGTATAGAACCCCCTTTGC
ATATTGGGCTAAATCACCTT
>Rosalind_6620
TAGCTAAGGTGTCTAAGGGCTACACGAACAAAAGGTACTACTATCTAGTCGAATCTATCC
AAGTCCCTGGGATAGGCGGGTGTCGTTAACTCTCCGGGAGAGCAAAGGCTGATACTCTGT
ACGATCTTTACTATTACTACTTAGACTTAAGCTGTTCGCTGTGATGAGAATTCTTACAAG
AAGCCGTATGTTGAGGTGTTTACTGGGTTCTGCGGCAGCTCTCGGGCGAGTTTCCGAATT
ACGCTCACGACGATCGAGTCTACGTGTCGCGATCTTACGATCCGATGATGTAATCCTTTC
TACTTGAGCATTATTCGTTACACTCGGATCAGCTACAATACAACCGTATCAGCTTATGCG
CCGGATGTTGTCAGCATGGAAAAACCCATACAATCGTAGCACAGATCAGGGAGTTCTACG
CAAAGTTACGGAGCCATTAACTCGAGTGCGAGACTTGCGCAGAAGTGCCCTGTCGTGAGC
AGTGTAGTTAAACTGTTGTCTAATCTGCAGAAATAAAATCGCGTCTCAACAGATCCGACG
CTGTGGCAGCACACTTGAAAACCTAGAGTCTGCTTACATTGTAACGGATATGGACTCCCT
CATGCTAATCGTACCACTCTCGCACCTGCGCAGAGGGTAGGCAGGCGAAAGACCGTGACC
CGGCCCCCACGTAACGGGAAAATTCTTTGTCCAACCCGCTACCCCTGGTTTAAGATGTCC
TGGTGCTTTCCGCCATGTATTCGTTATTCAACTAATGTTTATGTCTCCTTTCTAGGGCAT
TCGGTTTATTAGATTAGCGGCCACGGGGATAGCCTTTTCGGTGGATCTATACGGTTGCAT
TGAACAATCTGCAAACCCCTTGTGCCGCATCCCTCGTTGGAGGTTACGCTTCGAACGCAC
AGCATCTAACATCACCCCAATTGGGTCTTCCCGTTCGACAAGATGCAATACTGTCACTAC
AGGGACAGTTAAACCGAGTG
>Rosalind_3293
CTGACGTGGACCGCCATACATTGCCTCGTCGCTCGCACAGGCTTCGCCAGGCTACCACTG
TCGCCGTCACGAAGCCTGATAGTCTCTCCGTAGTCACGTAGGCACTTGGAGCTTTTATGC
CCAGCTTAGGGGTGTTCATCTTGTGGAGTGTCGGCGTTCAGCAGTGGAATCCATTGCACG
TCGAGCCTTACTCCACCCTATGAAAACCAACAGGGCTGTGTTAACGGTGGTGTCCGGGTA
TGCCAGTCCTCATCAGCGGGCCTACGGCTAGTACGCACCGTGCATCTCCACCTGTGACAC
GGGCCACGTACTAGCTTCAAAGTACATAGTGCGGTGGGATAGCTGACGAGCGTACTGCCT
CGTTCGTGCGAGGCTGACTGGGAATGTTATCTCCGTGGCCGCAACTGTCAGGCTAATCCT
TAAAAGCTAAATAGTGCACTCCGTAATTAAAGGACTGGTGAGGATTCGGTCCACACGCCA
CCTAGGCTCTTGGAAACTAGCTATGAGAAGCTATCCTCCGAATCTTCCATCGGTGGCGCA
TTTCTGTTGGACAACACCACCACCCATTACCGATCGCCAAGTGACGACCTAACAGTATCT
CCCAGTCGATGTAGGTAGCAGCGCCCGGAACGGCAAGTTTGTACAAAACGACGTATTTAC
GGCATCTTCTATTTAAGTTGCGAAACCGATGGGTCAGGATTTGTTTGACCATAAGGTATG
TTTGCCAGACACACCGCACTACTTTACGGAGTTATGCTACGTTGTATCATGGAGCTCTAG
AACACTGAGACAAGGATCCTAGATGCTATGGTTGGCTCCGTGTCTTAATATATTTGACTG
CTTCCGATCGGAGAACGTGCATTCTCGGTTCCCCCGAGCGTCAGATGCCTGCCTGTTGAT
TCGGGATGAGTCTCCGGGATTGGTGTGTCCGAAGCCAGCCGGGGCCCATCGCACGTGAAA
GTGACCCGTAACTCATGCAG
>Rosalind_3621
GATATCGAAGACCTAACTAGTCTCCTTAGTGAAGCATAAGGTTAGGACTCAACTTGCTTC
CGGTAGTGGTCGAAGCACGCGGAATAACGGCGGCCTCGCTTAGTTACAACATGTGCATTA
CACTACTGCAGTGACTCAAGGCAGTAGATGCCCCCTGGGGGCTCTATGGACGTGAAGCCT
TTATCTGAAGAACACTTGGTAGTAAGCGCCAGACGTCCCCGGTTTTCCACTTCCTTCTAA
CCTCAAAACTGTGTTTCCGTAGCTCAACTGGTAATGGCGCCAAGTCCCGCGTGCATAGGT
AGTAGCTGTCGGCGCAAGCCGCGGCAAAATTGGAAAACATCGGCTAACGTCGCCCAGGAT
CGACACGTAAACACCATTAAACGACCCGCAGACCGTAATGAACTACAATTAGAGAGCCGA
TATCAGCTGTACAGGACTGCGTGCCGTTGTTAAAGTCGTACACGATCTATCCATCGTAAT
CTGCTGATCCCGTTAAAGATTGATACTACGGTACGCGTGTTTACGTTGGTATAAACAGAA
CTAAGATCCCAAGCCGCGGATCTATGATAGGGCTAGATTGGCTACCGTGCGTTATTCTGC
TTTTCTCGAAACCACGGGAATCGCAGATGATCTCTGGTGCTCATTTGAAATGACATGTTT
GTTAACTGGCCGGGATGTGCGCAATTCGAGGGTGTCAATAGCCCCTTAAACAAAGAGTTC
CGGTTTCTAGTGTCACGGCTGTAAACGTCTGCACTAATTTATCAACGAGTGGGTTCTTGA
GCCGGATGGATCTTGGAGTAGTCGACTCTGTTAGAGAGTGAAGTGAGACAAGAGTCATAA
CAGGAACTGGAATTCCACAAGACGCGAGTCGTTTATTTGCTGGACTAAGGGCCGTGTGCA
CAAGTAATAACGTATAGACACAGGGCTGGGTCCGTTAACCACTGTTTCTAACATCAATTG
GGGGGCTAAAACTGAGGAAA
>Rosalind_0486
GGAGTTGGGCTCAGCAAGGTATGGGCAACTCGCGTTCTCGCGTACTGTCAAATCTGCGCG
AGCCGGGATCACGGTCGACGACACGAAACTGTTGGGCAAGATTTAGATAACGATTAAATA
TAAACGTAATTCGATTACTGGGTGTGCTATAATTCGTGTCCGCATAGAAACATGACCGAC
ATGTAAATAGACATGGGCATTGATCGATGGATGGTAGATGGAGCGCTTAAAGGGCCATAA
CAACAACGCTCACTATCAAAGGGGTTGCATTTCCAAATTCTGCGACAGGTTGGACACATA
TGTCGGAGATCCTATAACCGAGAACAGAAATGTGTAGGGCGGAGATAGCCTGTTGTGGGC
CTAAAGAGGACCCTCCCTTAAGAGAATGACGGACAAGTCTCACAGGAGGGAGAAGCAGTA
GCGATGGAATATTATCACAGTAGGAGCTACCTGATGGCGCTGATTCCCAGGCAAAATTTG
TTAGTCCAGCTACCGATAGATGTAGAGAACAAACACATTTGCCTACGTATAAGCCGGACA
GAGACTGAGGGCCTTCACAACGGAGGGTCTCAATCAAAAGCGGGGATACGATTGACGCCC
CGTCAAGAGAAAACAGCTGGTCTTGGATGTGCTTCCAGGCTTCATTTAGGGGGGCCTAAA
AATCCACAGTCGGTCCCCCAAGGAAGATAACATCCAACACAGGGTCAATATCACGACCGT
TGGGGTCCTCTTATGTCCGCCGCCCAAGTCGGGCATGATCTTCGTCTTAGTCCCTACTCA
GATTGGGATTGGTCACATCCTCTCCGAGTTGTAGACTACGCATGGAGGCCCCATCACGCC
CGGCGCTTAACTCGAGGGGCTGCCCTACAATTAGACTATAGTCAAAGTGGGTCCGGTACG
TCTGTTTCTATAGGTTCCGGTCCGCGAGCCTCAAAACCCCGCAGCCAGAGGGTATGAACT
CAAGGACAGAGGGCTCAAGA
>Rosalind_9787
AAGCGAACTTCAGGGAGCAGTAATGGCTTTCGGTAGAACCGGCAACTCCTAGTCGCATTA
TGCGCATAATCGCTACTCTTCTGCCCGGCCCTCCGACTTGTGCGCTGCGCTCGTCGGCAA
GCAGATGTCCACTCGGGTTCAGCAGCCCGTTACCTGCGTTATCATGAAAACAATTGCATT
AGGAATGAAGCCAATCACTCTGAGCACCTTGTCTCAGGGACTAGCAAGGAGAACTACTAT
GATAGCGCTACTATCAGTTTTTAAAGACGTCCGCGGGCACATCAATTAATCGACCCACTT
GGGGCATTATGGGGGCTCTAATAGAATAGTTCCTAAAACCTTAACCTCGATCCGCGAGAC
TCGGTCTTCGTAACAAACGCCGGCCCGGTCATTGGGTAAGAATCGTGAAGGTGTTCTTTC
AAATCTGTCCAACGCCAATACCTGAGAGTATGATGTCGACCTTAGCTGCGCCGGCCACCT
CTGACATCTATCATACTTACCGATGTAAGATCGGTCGCAATGCCCTCTGTGAGTGACAAA
GGAATTGGCGAAGCTCGATCCCTTTGAACGTTGAAGCCCGTACCTCTACAACCAGCGGAT
GCATCCATGGAGCGGATACCGTTGTTAATAGTCTTTGACGTCCTGATGTTTTGACCGCCC
GCTTTTGAAATGTCTCAGGTGATTCGGTGCGAGTAAAACTGGTGCTAACTCTAAACCACT
AGGGAGTGCTCGCGTCTCCCAAATTTTTCCTTTACTAACACCACACGACCGTAGTTCTAC
GGTTTTGGAATCTTGGTACCCGCCGAGAACACCGCGGGGGCTCCACATTTCATTATGAGT
GCAACGAGGGAGCGCGTTTGGGTCTTCCAGCTATAAAGGTCTCTCTAGAGATTGTGGAGC
ATTTTTATCCGCTCGAGAATCAGTCTTACCGTTCTATATCACCAATACAGAATGCCCCCG
CCGCGGAGGCTTCTTCTGAC
>Rosalind_6379
AGTTCGAATTACCGACCCGAGGGCCAGCCTGTGAATAAGTCGCTTATTGCTACACGTTTA
AGATATTCTTAAGGAGATGGCACAAGACGGATGGAGGACAGAACTAAGGCGTTCCCCGGC
GAAACAGAGTATTTGAAGACTGACATCCGCTATAAGAGGTATTACGTCAGTCCTCCCCGC
CGTTTGAGTGGCGTGCGCCCGGCGAAGCCCAACCCCTCAGAGAAAGTTCCGCTGTCCGGG
CCGAGTCCTTAAACCATGTGCTCGTGTGTACTGTTCGGCATTTCTACCATTGGGAGGTAT
ATACCGCAGGGTTATTGACTCTGGACCCCCGGGCACACACGTGAGGCTTTACACCACAAC
TATATCAGAGTAAAAACGCTAGGCGGAGCAGCACCTGGAATAATTTAGCTGGTCATGTTA
CACTGCGTTTGGGAGTCTCTGCAACCTTAGGATAGTCGCAGGGGACTAGTTGACTATATC
ACGTATCTGTATCTGTGGACCCCAGAGGTTTCTAGCGAATTTCGGGGCGAATTTTTGACG
CCCCCGCTCTTGCTTGATAGGTGGTGTAATTATGCCGCACCCGTGGTCTGCACCCCCTGC
AATAGCTTCATGAACGATTGGCTACCTACGTCTGAGAGAACCGTGTGGTTGGTAACACTA
AGACATAGTGATAATGGCAGACAAAAATTCAGACTCTAATAAGTGCTATGAGATCATCCA
AGCTATGCAACACGCGGTGGAATTCCCATTCGTGTACATTTTCTACGACCGCTGCTGGTA
GAAGTACGCTAAACTCCTCATAATCCTCCAGAGCGTGCTAAAAATCTTGTAGAACCGTCA
CGGTTAGCCGTGATCAAGAGCTGAAGTAACAATAGTGCTTAGTCCCGACGACATCCGCGT
CAGTCTTATATATCGAGGAAGACTATTATCCTGGACTGCACACAAAGTCAGATACGTGGC
TCTCTCATCGCTTTCCCTGA"""


# Procesar datos
secuencias = leer_fasta(entrada_fasta)
consenso, perfil = calcular_matriz_perfil_y_consenso(secuencias)


# Imprimir resultados
imprimir_resultados(consenso, perfil)
